# Setup Guide

This guide covers advanced setup options, configuration, and integration scenarios for IEquatable-Extensions.

## Table of Contents

- [Prerequisites](#prerequisites)
- [Installation](#installation)
- [Configuration](#configuration)
- [Source Generator Setup](#source-generator-setup)
- [IDE Integration](#ide-integration)
- [Build Configuration](#build-configuration)
- [Troubleshooting](#troubleshooting)

## Prerequisites

### Minimum Requirements

- **.NET SDK**: 8.0 or higher
- **C# Version**: 10.0 or higher (for source generators and new language features)
- **IDE**: Visual Studio 2022, Visual Studio Code, or JetBrains Rider

### Optional Tools

- **NuGet CLI**: For command-line package management
- **Visual Studio Extensions**: For enhanced IntelliSense support
- **ReSharper**: For additional code analysis

## Installation

### Standard Installation

For most projects, a standard NuGet package installation is sufficient:

```bash
dotnet add package IEquatable-Extensions
```

### Development Build Installation

To use the latest development build from a local source:

1. Clone the repository:
   ```bash
   git clone https://github.com/Chris-Wolfgang/IEquatable-Extensions.git
   cd IEquatable-Extensions
   ```

2. Build the project:
   ```bash
   dotnet build --configuration Release
   ```

3. Pack the NuGet package:
   ```bash
   dotnet pack --configuration Release
   ```

4. Add the local package source:
   ```bash
   dotnet nuget add source ./artifacts/packages/Release --name LocalIEquatableExtensions
   ```

5. Install from the local source:
   ```bash
   dotnet add package IEquatable-Extensions --source LocalIEquatableExtensions
   ```

## Configuration

### Global Using Directives

To make the extensions available throughout your project without explicit using statements, add to your `.csproj` or `GlobalUsings.cs`:

```csharp
global using IEquatableExtensions;
global using IEquatableExtensions.Helpers;
global using IEquatableExtensions.Attributes;
```

### Namespace Configuration

If you want to customize the namespace behavior:

```xml
<!-- In your .csproj file -->
<PropertyGroup>
  <RootNamespace>YourApp</RootNamespace>
  <UseImplicitUsings>enable</UseImplicitUsings>
</PropertyGroup>
```

## Source Generator Setup

### Enabling Source Generators

Source generators are enabled by default when you install the package. Ensure your project file has:

```xml
<PropertyGroup>
  <LangVersion>latest</LangVersion>
  <Nullable>enable</Nullable>
</PropertyGroup>
```

### Configuring Generator Behavior

Create an `IEquatableExtensions.json` file in your project root:

```json
{
  "GenerateOperators": true,
  "GenerateGetHashCode": true,
  "GenerateEquals": true,
  "NullableContext": "enable",
  "StringComparison": "Ordinal",
  "IncludeDebuggerDisplay": true
}
```

### Generator Options

| Option | Default | Description |
|--------|---------|-------------|
| `GenerateOperators` | `true` | Generate `==` and `!=` operators |
| `GenerateGetHashCode` | `true` | Generate `GetHashCode` override |
| `GenerateEquals` | `true` | Generate `Equals` methods |
| `NullableContext` | `enable` | Nullable reference type handling |
| `StringComparison` | `Ordinal` | Default string comparison mode |
| `IncludeDebuggerDisplay` | `false` | Add `DebuggerDisplay` attribute |

### Viewing Generated Code

To see the code generated by source generators:

#### Visual Studio 2022
1. Expand the project in Solution Explorer
2. Expand the "Dependencies" node
3. Expand "Analyzers"
4. Expand "IEquatable-Extensions"
5. View the generated files

#### Command Line
Add this to your `.csproj`:

```xml
<PropertyGroup>
  <EmitCompilerGeneratedFiles>true</EmitCompilerGeneratedFiles>
  <CompilerGeneratedFilesOutputPath>Generated</CompilerGeneratedFilesOutputPath>
</PropertyGroup>
```

Generated files will appear in the `obj/Generated` directory.

## IDE Integration

### Visual Studio 2022

1. Install the latest version of Visual Studio 2022
2. Ensure the ".NET desktop development" workload is installed
3. The package will provide IntelliSense automatically

### Visual Studio Code

1. Install the C# extension by Microsoft
2. Install the C# Dev Kit (optional but recommended)
3. Ensure .NET SDK 8.0+ is installed and in PATH

```json
// .vscode/settings.json
{
  "dotnet.preferCSharpExtension": true,
  "omnisharp.enableRoslynAnalyzers": true
}
```

### JetBrains Rider

Rider has built-in support for source generators. No additional configuration needed.

## Build Configuration

### CI/CD Integration

#### GitHub Actions

```yaml
name: Build

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Setup .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: 8.0.x
    - name: Restore dependencies
      run: dotnet restore
    - name: Build
      run: dotnet build --no-restore --configuration Release
    - name: Test
      run: dotnet test --no-build --configuration Release
```

#### Azure Pipelines

```yaml
trigger:
- main

pool:
  vmImage: 'ubuntu-latest'

variables:
  buildConfiguration: 'Release'

steps:
- task: UseDotNet@2
  inputs:
    version: '8.0.x'
- task: DotNetCoreCLI@2
  displayName: 'Restore packages'
  inputs:
    command: 'restore'
- task: DotNetCoreCLI@2
  displayName: 'Build'
  inputs:
    command: 'build'
    arguments: '--configuration $(buildConfiguration) --no-restore'
- task: DotNetCoreCLI@2
  displayName: 'Test'
  inputs:
    command: 'test'
    arguments: '--configuration $(buildConfiguration) --no-build'
```

### Package Reference Options

#### Version Pinning

For production applications, pin to a specific version:

```xml
<PackageReference Include="IEquatable-Extensions" Version="1.2.3" />
```

#### Floating Versions

For development or when you want automatic updates:

```xml
<!-- Latest stable -->
<PackageReference Include="IEquatable-Extensions" Version="*" />

<!-- Latest 1.x version -->
<PackageReference Include="IEquatable-Extensions" Version="1.*" />

<!-- Latest preview -->
<PackageReference Include="IEquatable-Extensions" Version="*-*" />
```

## Troubleshooting

### Source Generator Not Running

**Problem**: Generated code is not appearing

**Solutions**:
1. Clean and rebuild the solution:
   ```bash
   dotnet clean
   dotnet build
   ```

2. Restart your IDE

3. Check that `LangVersion` is set to `latest` or `11.0`+

4. Verify the package is properly installed:
   ```bash
   dotnet list package
   ```

### IntelliSense Not Working

**Problem**: Extension methods not showing in IntelliSense

**Solutions**:
1. Add explicit using directive:
   ```csharp
   using IEquatableExtensions;
   ```

2. Check that the package reference exists in `.csproj`

3. Restart OmniSharp (VS Code) or Visual Studio

### Build Errors

**Problem**: Compilation errors related to generated code

**Solutions**:
1. Ensure nullable reference types are enabled if using nullable features:
   ```xml
   <Nullable>enable</Nullable>
   ```

2. Check for conflicting equality implementations

3. Review the generated code for conflicts with manually written code

### Performance Issues

**Problem**: Slow build times with source generators

**Solutions**:
1. Use incremental builds:
   ```xml
   <PropertyGroup>
     <UseSharedCompilation>true</UseSharedCompilation>
   </PropertyGroup>
   ```

2. Exclude unnecessary files from generation:
   ```xml
   <ItemGroup>
     <Compile Remove="Generated/**/*.cs" />
   </ItemGroup>
   ```

### NuGet Package Not Found

**Problem**: Cannot find the package in NuGet

**Solutions**:
1. Clear NuGet cache:
   ```bash
   dotnet nuget locals all --clear
   ```

2. Verify package source:
   ```bash
   dotnet nuget list source
   ```

3. Add nuget.org as a source:
   ```bash
   dotnet nuget add source https://api.nuget.org/v3/index.json -n nuget.org
   ```

## Advanced Scenarios

### Multi-Targeting

If your library needs to target multiple frameworks:

```xml
<PropertyGroup>
  <TargetFrameworks>net8.0;net7.0;net6.0</TargetFrameworks>
</PropertyGroup>
```

### Custom Equality Strategies

Create custom equality strategies by implementing `IEqualityComparer<T>`:

```csharp
using IEquatableExtensions.Abstractions;

public class CustomComparer : IEqualityComparer<MyType>
{
    public bool Equals(MyType x, MyType y)
    {
        // Custom equality logic
    }

    public int GetHashCode(MyType obj)
    {
        // Custom hash code logic
    }
}
```

### Integration with Dependency Injection

Register comparers in your DI container:

```csharp
services.AddSingleton<IEqualityComparer<Customer>, CustomerComparer>();
```

## Next Steps

- Read the [Getting Started](getting-started.md) guide for usage examples
- Explore the [API Reference](../api/index.md) for detailed documentation
- Check the [examples](../../examples/) folder for real-world scenarios
- Visit the [GitHub repository](https://github.com/Chris-Wolfgang/IEquatable-Extensions) for source code

## Getting Help

If you encounter issues not covered here:

1. Check [GitHub Issues](https://github.com/Chris-Wolfgang/IEquatable-Extensions/issues)
2. Search [GitHub Discussions](https://github.com/Chris-Wolfgang/IEquatable-Extensions/discussions)
3. Create a new issue with:
   - Your .NET version (`dotnet --version`)
   - Your OS and IDE
   - A minimal reproducible example
   - Error messages and stack traces
